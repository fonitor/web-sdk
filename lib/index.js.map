{"version":3,"file":"index.js","sources":["../src/util/index.js","../src/config/index.js","../src/log/jsLog.js","../src/log/rescourceLog.js","../src/log/httpLog.js","../src/log/page.js","../src/queue/index.js","../src/index.js"],"sourcesContent":["/**\n * 工具类\n */\nexport default class Util {\n    \n    /**\n     * 基础配置\n     * @param {*} options \n     */\n    constructor(options) {\n        let device = {},\n            ua = navigator.userAgent\n        device.ios = device.android = device.iphone = device.ipad = device.androidChrome = false\n        device.isWeixin = /MicroMessenger/i.test(ua)\n        device.os = \"web\"\n        device.deviceName = \"PC\"\n\n        this.device = device\n        this.ua = ua\n        this.o = (window.location.href, \"\")\n        this.monitorIp = ''\n        this.country = ''\n        this.uuid = ''\n        this.options = !this.isBlank(options) ? options : {}\n    }\n\n    /**\n     * 单例\n     * @param {*} options\n     * @return {?}\n     */\n    static getInstance(options = {}) {\n        if (!Util.instance) {\n            Util.instance = new Util(options)\n        }\n        return Util.instance\n    }\n\n    /**\n     * 获取设备信息\n     * @return {?}\n     */\n    getDevice() {\n        let device = this.device,\n            ua = this.ua\n        /** @type {(Array<string>|null)} */\n        let android = ua.match(/(Android);?[\\s\\/]+([\\d.]+)?/);\n        /** @type {(Array<string>|null)} */\n        let showEffects = ua.match(/(iPad).*OS\\s([\\d_]+)/);\n        /** @type {(Array<string>|null)} */\n        let showPackageConstants = ua.match(/(iPod)(.*OS\\s([\\d_]+))?/);\n        /** @type {(Array<string>|boolean|null)} */\n        let showConstants = !showEffects && ua.match(/(iPhone\\sOS)\\s([\\d_]+)/);\n        /** @type {(Array<string>|null)} */\n        let cache_message = ua.match(/Android\\s[\\S\\s]+Build\\//);\n\n        if (android && (device.os = \"android\", device.osVersion = android[2], device.android = true, device.androidChrome = 0 <= ua.toLowerCase().indexOf(\"chrome\")), (showEffects || showConstants || showPackageConstants) && (device.os = \"ios\", device.ios = true), showConstants && !showPackageConstants && (device.osVersion = showConstants[2].replace(/_/g, \".\"), device.iphone = true), showEffects && (device.osVersion = showEffects[2].replace(/_/g, \".\"), device.ipad = true), showPackageConstants && (device.osVersion = showPackageConstants[3] ? showPackageConstants[3].replace(/_/g, \".\") : null, device.iphone = true), device.ios && device.osVersion && 0 <= ua.indexOf(\"Version/\") && \"10\" === device.osVersion.split(\".\")[0] && (device.osVersion = ua.toLowerCase().split(\"version/\")[1].split(\" \")[0]), device.iphone) {\n            /** @type {string} */\n            device.deviceName = \"iphone\";\n            var beginWidth = window.screen.width;\n            var upperHeight = window.screen.height;\n            if (320 === beginWidth && 480 === upperHeight) {\n                /** @type {string} */\n                device.deviceName = \"iphone 4\";\n            } else {\n                if (320 === beginWidth && 568 === upperHeight) {\n                    /** @type {string} */\n                    device.deviceName = \"iphone 5/SE\";\n                } else {\n                    if (375 === beginWidth && 667 === upperHeight) {\n                        /** @type {string} */\n                        device.deviceName = \"iphone 6/7/8\";\n                    } else {\n                        if (414 === beginWidth && 736 === upperHeight) {\n                            /** @type {string} */\n                            device.deviceName = \"iphone 6/7/8 Plus\";\n                        } else {\n                            if (375 === beginWidth && 812 === upperHeight) {\n                                /** @type {string} */\n                                device.deviceName = \"iphone X/S/Max\";\n                            }\n                        }\n                    }\n                }\n            }\n        } else {\n            if (device.ipad) {\n                /** @type {string} */\n                device.deviceName = \"ipad\";\n            } else {\n                if (cache_message) {\n                    /** @type {string} */\n                    var d = cache_message[0].split(\";\")[1].replace(/Build\\//g, \"\");\n                    /** @type {string} */\n                    device.deviceName = d.replace(/(^\\s*)|(\\s*$)/g, \"\");\n                }\n            }\n        }\n        if (-1 == ua.indexOf(\"Mobile\")) {\n            /** @type {string} */\n            let ua = navigator.userAgent.toLowerCase();\n            if (device.browserName = \"\\u672a\\u77e5\", 0 < ua.indexOf(\"msie\")) {\n                /** @type {string} */\n                var assignmentUrl = ua.match(/msie [\\d.]+;/gi)[0];\n                /** @type {string} */\n                device.browserName = assignmentUrl.split(\"/\")[0];\n                /** @type {string} */\n                device.browserVersion = assignmentUrl.split(\"/\")[1];\n            }\n            if (0 < ua.indexOf(\"firefox\")) {\n                /** @type {string} */\n                assignmentUrl = ua.match(/firefox\\/[\\d.]+/gi)[0];\n                /** @type {string} */\n                device.browserName = assignmentUrl.split(\"/\")[0];\n                /** @type {string} */\n                device.browserVersion = assignmentUrl.split(\"/\")[1];\n            }\n            if (0 < ua.indexOf(\"safari\") && ua.indexOf(\"chrome\") < 0) {\n                /** @type {string} */\n                assignmentUrl = ua.match(/safari\\/[\\d.]+/gi)[0];\n                /** @type {string} */\n                device.browserName = assignmentUrl.split(\"/\")[0];\n                /** @type {string} */\n                device.browserVersion = assignmentUrl.split(\"/\")[1];\n            }\n            if (0 < ua.indexOf(\"chrome\")) {\n                /** @type {string} */\n                assignmentUrl = ua.match(/chrome\\/[\\d.]+/gi)[0];\n                /** @type {string} */\n                device.browserName = assignmentUrl.split(\"/\")[0];\n                /** @type {string} */\n                device.browserVersion = assignmentUrl.split(\"/\")[1];\n            }\n        }\n\n        device.webView = (showConstants || showEffects || showPackageConstants) && ua.match(/.*AppleWebKit(?!.*Safari)/i)\n\n        this.device = Object(this.device, device)\n\n        return this.device;\n    }\n\n    /**\n     * 判断数据类型\n     * util.isType().isArray(……)\n     */\n    isType() {\n        let _obj = {\n            isNumeric: 'Number',\n            isBoolean: 'Boolean',\n            isString: 'String',\n            isNull: 'Null',\n            isUndefined: 'Undefined',\n            isSymbol: 'Symbol',\n            isPlainObject: 'Object',\n            isArray: 'Array',\n            isRegExp: 'RegExp',\n            isDate: 'Date',\n            isfunction: 'Function',\n            isWindow: 'Window'\n        }\n\n        let _type = {},\n            _toString = _type.toString\n\n        for (var key in _obj) {\n            if (!_obj.hasOwnProperty(key)) break\n            _type[key] = (function () {\n                var reg = new RegExp(\"^\\\\[object \" + _obj[key] + \"\\\\]$\")\n                return function anonymous(val) {\n                    return reg.test(_toString.call(val))\n                }\n            })()\n        }\n\n        return _type\n    }\n\n    /**\n     * 判断数据\n     * @param {*} obj \n     */\n    isBlank(obj) {\n        return obj === null || obj === undefined || obj === \"\";\n    }\n\n    /**\n     * 解析url中拼接的参数\n     * @param url\n     * @return {{参数名: string}}\n     */\n    parseUrlParams(url) {\n        if (url.indexOf(\"?\") !== -1) {\n            url = url.substr(url.indexOf(\"?\") + 1);\n        }\n        let paramsArr = url.match(/[^\\?\\=\\&]*\\=[^\\?\\=\\&]*/g);\n        let params = {};\n        if (paramsArr != null) {\n            paramsArr.forEach(item => {\n                let kv = item.split(\"=\");\n                params[decodeURIComponent(kv[0])] = decodeURIComponent(kv[1]);\n            });\n        }\n        return params;\n    }\n\n    /**\n     * 解析url\n     * @param {*} url \n     */\n    getQueryObject(url) {\n        let search = url.substring(url.lastIndexOf(\"?\") + 1),\n            obj = {},\n            reg = /([^?&=]+)=([^?&=]*)/g,\n            base_url = url.split(\"?\")[0]\n        search.replace(reg, (rs, $1, $2) => {\n            let name = decodeURIComponent($1),\n                val = decodeURIComponent($2);\n            val = String(val);\n            obj[name] = val;\n        })\n\n        return {\n            baseUrl: base_url,\n            query: obj\n        }\n    }\n\n    /**\n   * 组装url 参数\n   * @param {*} queryObject \n   */\n    makeQuery(queryObject) {\n        let query = Object.entries(queryObject)\n            .reduce((result, entry) => {\n                result.push(entry.join('='))\n                return result\n            }, []).join('&')\n        return `?${query}`\n    }\n\n    /**\n     * 删除url 指定参数\n     * @param {*} name \n     */\n    funcUrlDel(name) {\n        var loca = location;\n        var baseUrl = loca.origin + loca.pathname + \"?\";\n        var query = loca.search.substr(1);\n        if (query.indexOf(name) > -1) {\n            var obj = {};\n            var arr = query.split(\"&\");\n            for (var i = 0; i < arr.length; i++) {\n                arr[i] = arr[i].split(\"=\");\n                obj[arr[i][0]] = arr[i][1];\n            }\n            delete obj[name];\n            var url = baseUrl + JSON.stringify(obj).replace(/[\\\"\\{\\}]/g, \"\").replace(/\\:/g, \"=\").replace(/\\,/g, \"&\");\n            return url\n        }\n    }\n\n\n    /**\n     * 获取唯一uuid\n     * @return {?}\n     */\n    getUuid() {\n        /** @type {number} */\n        var _transactionName = (new Date).getTime();\n        return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n            /** @type {number} */\n            var r = 16 * Math.random() | 0;\n            return (\"x\" == c ? r : 3 & r | 8).toString(16);\n        }) + \"-\" + _transactionName;\n    }\n\n    /**\n     * @return {?}\n     */\n    getCustomerKey() {\n        var uuid = this.getUuid();\n        var obj = this.getCookie(\"monitorAppKey\");\n        if (!obj) {\n            /** @type {!Date} */\n            var dateExpires = new Date;\n            dateExpires.setTime(dateExpires.getTime() + 15552e7);\n            /** @type {string} */\n            document.cookie = \"monitorAppKey=\" + uuid + \";Path=/;domain=\" + this.o + \";expires=\" + dateExpires.toGMTString();\n            obj = uuid;\n        }\n        this.uuid = obj\n        return obj;\n    }\n\n    /**\n     * 获取cookie\n     * @param {*} name \n     */\n    getCookie(name) {\n        let t;\n        /** @type {!RegExp} */\n        let re2 = new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\");\n        return document.cookie.match(re2) ? (t = document.cookie.match(re2), unescape(t[2])) : \"\";\n    }\n\n    /**\n     * 获取ip地址\n     * @param {*} cb \n     */\n    getIp(cb) {\n        if (this.getCookie('monitor_web_ip')) {\n            if (this.isType().isfunction(cb)) {\n                cb()\n            }\n        }\n        // 搜狐IP地址查询接口（可设置编码）\n        this.loadJs('//pv.sohu.com/cityjson?ie=utf-8', _ => {\n            var opt_by = this.monitorIp = returnCitySN ? returnCitySN.cip : \"\";\n            /** @type {string} */\n            var urlSafeNodeName = this.country = encodeURIComponent(returnCitySN ? returnCitySN.cname : \"\");\n            /** @type {!Date} */\n            var dateExpires = new Date;\n            dateExpires.setTime(dateExpires.getTime() + 864e5);\n            /** @type {string} */\n            document.cookie = \"monitor_web_ip=\" + opt_by + \";Path=/;domain=;expires=\" + dateExpires.toGMTString();\n            /** @type {string} */\n            document.cookie = \"monitor_web_province=\" + urlSafeNodeName + \";Path=/;domain=;expires=\" + dateExpires.toGMTString();\n            if (this.isType().isfunction(cb)) {\n                cb()\n            }\n        }, _ => {\n            if (this.isType().isfunction(cb)) {\n                cb()\n            }\n        })\n    }\n\n    /**\n     * 页面载入js文件\n     * @param {*} js \n     * @param {*} callback \n     * @param {*} url \n     */\n    loadJs(js, callback, url) {\n        /** @type {!Element} */\n        var script = document.createElement(\"script\");\n        /** @type {number} */\n        script.async = 1;\n        /** @type {string} */\n        script.src = js;\n        /** @type {!Function} */\n        script.onload = callback;\n        if (\"function\" == typeof url) {\n            /** @type {!Function} */\n            script.onerror = url;\n        }\n        /** @type {!Element} */\n        var mContainer = document.getElementsByTagName(\"script\")[0];\n        return mContainer.parentNode.insertBefore(script, mContainer), mContainer;\n    }\n\n    /**\n     * 创建一个base-64编码字符串\n     * base-64 解码使用方法是 atob() \n     * @param {*} str \n     */\n    b64EncodeUnicode(str) {\n        try {\n            return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function (canCreateDiscussions, index) {\n                return String.fromCharCode(\"0x\" + index);\n            }));\n        } catch (e) {\n            return str;\n        }\n    }\n\n    /**\n     * http 报错解析\n     * @param {*} s \n     * @return {?}\n     */\n    encryptObj(s) {\n        if (this.isType().isArray(s)) {\n            /** @type {!Array} */\n            var conf_shortcuts_icon = []\n            /** @type {number} */\n            var i = 0\n            for (; i < s.length; ++i) {\n                conf_shortcuts_icon[i] = this.encryptObj(s[i])\n            }\n            return conf_shortcuts_icon\n        }\n        if (this.isType().isPlainObject(s)) {\n            conf_shortcuts_icon = {}\n            for (i in s) {\n                conf_shortcuts_icon[i] = this.encryptObj(s[i])\n            }\n            return conf_shortcuts_icon\n        }\n        return 50 < (s = s + \"\").length && (s = s.substring(0, 10) + \"****\" + s.substring(s.length - 9, s.length)), s\n    }\n\n    /**\n     * 日志通用属性\n     */\n    getCommonProperty() {\n        let logObj = {},\n            device = this.device,\n            userInfo = (this.options.hasOwnProperty('monitorUser') && util.isType().isPlainObject(this.options.monitorUser)) ? this.options.monitorUser : {}\n        logObj.happenTime = new Date().getTime() // 日志发生时间\n        logObj.webMonitorId = this.options.WEB_MONITOR_ID || '' // 用于区分应用的唯一标识（一个项目对应一个）\n        logObj.simpleUrl = window.location.href.split('?')[0].replace('#', '') // 页面的url\n        logObj.customerKey = this.uuid // 用于区分用户，所对应唯一的标识，清理本地数据后失效\n        logObj.pageKey = ''  // 用于区分页面，所对应唯一的标识，每个新页面对应一个值\n        logObj.deviceName = device.deviceName || '' // 设备名称\n        logObj.os = device.os + (device.osVersion ? \" \" + device.osVersion : \"\")\n        logObj.browserName = device.browserName\n        logObj.browserVersion = device.browserVersion\n        logObj.monitorIp = this.monitorIp  // 用户的IP地址\n        logObj.country = this.country  // 用户所在国家\n        // TODO 位置信息, 待处理\n        logObj.province = \"\"  // 用户所在省份\n        logObj.city = \"\"  // 用户所在城市\n        // 用户自定义信息， 由开发者主动传入， 便于对线上进行准确定位\n        logObj.userId = userInfo.userId || null\n        logObj.firstUserParam = userInfo.firstUserParam || null\n        logObj.secondUserParam = userInfo.secondUserParam || null\n\n        return logObj\n    }\n}","export const JS_ERROR = 'js_error'\nexport const RESOURCE_LOAD = 'resource_load'\nexport const HTTP_LOG = 'http_log'","import Util from \"../util/index\"\nimport * as error from '../config/index'\n\nconst util = Util.getInstance()\n\nexport default class jsLog {\n\n    constructor() {\n\n    }\n\n    /**\n     * 单例\n     * @return {?}\n     */\n    static getInstance() {\n        if (!jsLog.instance) {\n            jsLog.instance = new jsLog()\n        }\n        return jsLog.instance\n    }\n\n    /**\n     * 监控js报错\n     * onerror https://segmentfault.com/a/1190000011041164\n     */\n    recordJavaScriptError() {\n        let siftAndMakeUpMessage = (origin_errorMsg, origin_url, origin_lineNumber, origin_columnNumber, origin_errorObj) => {\n            let errorMsg = origin_errorMsg ? origin_errorMsg : ''\n            let errorObj = origin_errorObj ? origin_errorObj : ''\n            let errorType = \"\"\n            if (errorMsg) {\n                let errorStackStr = JSON.stringify(errorObj)\n                errorType = errorStackStr.split(\": \")[0].replace('\"', \"\");\n            }\n            let javaScriptErrorInfo = this.javaScriptErrorInfo(error.JS_ERROR, errorType + \": \" + errorMsg, errorObj)\n            console.log(javaScriptErrorInfo)\n        }\n\n        let jsMonitorStarted;\n        // 重写console.error, 可以捕获更全面的报错信息\n        let oldError = console.error;\n        console.error = () => {\n            // arguments的长度为2时，才是error上报的时机\n            // if (arguments.length < 2) return;\n            let errorMsg = arguments[0] && arguments[0].message\n            let url = util.o\n            let lineNumber = 0\n            let columnNumber = 0\n            let errorObj = arguments[0] && arguments[0].stack\n            if (!errorObj) errorObj = arguments[0]\n            // 如果onerror重写成功，就无需在这里进行上报了\n            !jsMonitorStarted && siftAndMakeUpMessage(errorMsg, url, lineNumber, columnNumber, errorObj)\n            return oldError.apply(console, arguments)\n        }\n\n        // 重写 onerror 进行jsError的监听\n        window.onerror = (errorMsg, url, lineNumber, columnNumber, errorObj) => {\n            // console.log(errorMsg)\n            jsMonitorStarted = true\n            let errorStack = errorObj ? errorObj.stack : null\n            siftAndMakeUpMessage(errorMsg, url, lineNumber, columnNumber, errorStack)\n        }\n        window.onunhandledrejection = (event) => {\n            /** @type {string} */\n            let errorMessage = \"\"\n            /** @type {string} */\n            let th_field = \"\"\n            th_field = \"object\" == typeof event.reason ? (errorMessage = event.reason.message, event.reason.stack) : (errorMessage = event.reason, \"\")\n            let url = util.o\n            th_field ? siftAndMakeUpMessage(errorMessage, url, 0, 0, \"UncaughtInPromiseError: \" + th_field) : null\n        }\n    }\n\n    /**\n     * js 错误（注意内存，使用深拷贝，以免基本信息被改动）\n     * @param {*} uploadType \n     * @param {*} errorMsg \n     * @param {*} errorStack \n     */\n    javaScriptErrorInfo(uploadType, errorMsg, errorStack) {\n        // 避免原数据错乱\n        let obj = JSON.parse(JSON.stringify(util.getCommonProperty()))\n        obj.uploadType = uploadType\n        obj.errorMessage = encodeURIComponent(errorMsg)\n        obj.errorStack = errorStack\n        obj.browserInfo = ''\n        return obj\n    }\n\n\n}","import Util from \"../util/index\"\nimport * as error from '../config/index'\n\nconst util = Util.getInstance()\n\nexport default class rescourceLog {\n    constructor() {\n\n    }\n\n    /**\n     * 单例\n     * @return {?}\n     */\n    static getInstance() {\n        if (!rescourceLog.instance) {\n            rescourceLog.instance = new rescourceLog()\n        }\n        return rescourceLog.instance\n    }\n\n    /**\n     * 资源报错监控\n     * 1）使用script标签的回调方法，在网络上搜索过，看到有人说可以用onerror方法监控报错的情况， 但是经过试验后，发现并没有监控到报错情况，至少在静态资源跨域加载的时候是无法获取的。\n     * 2）利用 performance.getEntries()方法，获取到所有加载成功的资源列表，在onload事件中遍历出所有页面资源集合，利用排除法，到所有集合中过滤掉成功的资源列表，即为加载失败的资源。 此方法看似合理，也确实能够排查出加载失败的静态资源，但是检查的时机很难掌握，另外，如果遇到异步加载的js也就歇菜了。\n     * 3）添加一个Listener（error）来捕获前端的异常，也是我正在使用的方法，比较靠谱。但是这个方法会监控到很多的error, 所以我们要从中筛选出静态资源加载报错的error, 代码如下：\n     */\n    recordResourceError() {\n        window.addEventListener('error', (e) => {\n            let typeName = e.target.localName\n            let sourceUrl = \"\"\n            switch (typeName) {\n                case 'link':\n                    sourceUrl = e.target.href || ''\n                    break\n                case 'script':\n                    sourceUrl = e.target.src || ''\n                    break\n                case 'img':\n                    sourceUrl = e.target.src || ''\n                    break\n                default:\n                    sourceUrl = e.target.src || ''\n            }\n            if (sourceUrl) sourceUrl = util.b64EncodeUnicode(encodeURIComponent(sourceUrl))\n\n            let resoureErrorInfo = this.resourceErrorInfo(error.RESOURCE_LOAD, sourceUrl, typeName)\n            console.log(resoureErrorInfo)\n        }, true);\n    }\n\n    /**\n     * 资源错误监控基础字段（注意内存，使用深拷贝，以免基本信息被改动）\n     * @param {*} uploadType \n     * @param {*} sourceUrl \n     * @param {*} typeName \n     */\n    resourceErrorInfo(uploadType, sourceUrl, typeName) {\n        let obj = JSON.parse(JSON.stringify(util.getCommonProperty()))\n        obj.uploadType = uploadType\n        obj.errorUrl = sourceUrl\n        obj.errorName = typeName;\n        obj.browserInfo = '';\n        return obj\n    }\n}","import Util from \"../util/index\"\nimport * as error from '../config/index'\n\nconst util = Util.getInstance(),\n    cache = []\n\nexport default class httpLog {\n    constructor() {\n        this.timeRecordArray = []\n    }\n\n    /**\n     * 单例\n     * @return {?}\n     */\n    static getInstance() {\n        if (!httpLog.instance) {\n            httpLog.instance = new httpLog()\n        }\n        return httpLog.instance\n    }\n\n    /**\n     * 监听jquery、zepto、自己封装ajax方法报错\n     * 我们监听 XMLHttpRequest 对象的两个事件 loadstart， loadend\n     * @return {?}\n     */\n    recordHttpError() {\n        let XMLHttpRequest = window.XMLHttpRequest\n\n        /**\n         * @param {string} name\n         * @return {undefined}\n         */\n        function fire(name) {\n            /** @type {!CustomEvent} */\n            var event = new CustomEvent(name, {\n                detail: this\n            })\n            window.dispatchEvent(event)\n        }\n\n\n        window.XMLHttpRequest = () => {\n            var xhr = new XMLHttpRequest;\n            return xhr.addEventListener(\"abort\", function () {\n                fire.call(this, \"ajaxAbort\")\n            }, false), xhr.addEventListener(\"error\", function () {\n                fire.call(this, \"ajaxError\")\n            }, false), xhr.addEventListener(\"load\", function () {\n                fire.call(this, \"ajaxLoad\")\n            }, false), xhr.addEventListener(\"loadstart\", function () {\n                fire.call(this, \"ajaxLoadStart\")\n            }, false), xhr.addEventListener(\"progress\", function () {\n                fire.call(this, \"ajaxProgress\")\n            }, false), xhr.addEventListener(\"timeout\", function () {\n                fire.call(this, \"ajaxTimeout\")\n            }, false), xhr.addEventListener(\"loadend\", function () {\n                fire.call(this, \"ajaxLoadEnd\")\n            }, false), xhr.addEventListener(\"readystatechange\", function () {\n                fire.call(this, \"ajaxReadyStateChange\")\n            }, false), xhr\n        }\n\n        window.addEventListener('ajaxLoadStart', (e) => {\n            let tempObj = {\n                timeStamp: new Date().getTime(),\n                event: e,\n                simpleUrl: window.location.href.split('?')[0].replace('#', ''),\n                uploadFlag: false,\n            }\n            cache.push(tempObj)\n        })\n        let self = this\n\n        window.addEventListener('ajaxLoadEnd', (e) => {\n            /** @type {number} */\n            let i = 0;\n            for (i; i < cache.length; i++) {\n                if (true === cache[i].uploadFlag) continue\n                if (cache[i].event.detail.status > 0) {\n                    if (\"blob\" === (cache[i].event.detail.responseType + \"\").toLowerCase()) {\n                        // 闭包\n                        !function (t) {\n                            /** @type {!FileReader} */\n                            let reader = new FileReader;\n                            /**\n                             * @return {undefined}\n                             */\n                            reader.onload = function () {\n                                /** @type {(ArrayBuffer|Blob|null|string)} */\n                                var result = reader.result;\n                                self.handleHttpResult(t, result);\n                            };\n                            try {\n                                reader.readAsText(cache[i].event.detail.response, \"utf-8\");\n                            } catch (e) {\n                                self.handleHttpResult(t, cache[i].event.detail.response + \"\");\n                            }\n                        }(i);\n                    } else {\n                        try {\n                            let response = cache[i] && cache[i].event && cache[i].event.detail;\n                            if (!response) {\n                                return;\n                            }\n                            let id = response.responseType;\n                            /** @type {string} */\n                            let result = \"\";\n                            if (!(\"\" !== id && \"text\" !== id)) {\n                                result = response.responseText;\n                            }\n                            if (\"json\" === id) {\n                                /** @type {string} */\n                                result = JSON.stringify(response.response);\n                            }\n                            self.handleHttpResult(i, result);\n                        } catch (e) {\n                        }\n                    }\n                }\n            }\n        })\n\n        this.fetch()\n\n    }\n\n\n\n    /**\n     * http 请求日志包装\n     * @param {*} i \n     * @param {*} tempResponseText \n     */\n    handleHttpResult(i, tempResponseText) {\n        if (!cache[i] || cache[i].uploadFlag === true) {\n            return;\n        }\n        let responseText = \"\"\n        try {\n            responseText = tempResponseText ? JSON.stringify(util.encryptObj(JSON.parse(tempResponseText))) : \"\"\n        } catch (e) {\n            responseText = \"\"\n        }\n        let simpleUrl = cache[i].simpleUrl,\n            currentTime = new Date().getTime(),\n            url = cache[i].event.detail.responseURL,\n            status = cache[i].event.detail.status,\n            statusText = cache[i].event.detail.statusText,\n            loadTime = currentTime - cache[i].timeStamp;\n\n        if (!url) return\n        let httpLogInfoStart = this.httpLogInfo(error.HTTP_LOG, simpleUrl, status, statusText, \"发起请求\", responseText, cache[i].timeStamp, 0)\n        console.log(httpLogInfoStart)\n        // httpLogInfoStart.handleLogInfo(error.HTTP_LOG, httpLogInfoStart)\n        let httpLogInfoEnd = this.httpLogInfo(error.HTTP_LOG, simpleUrl, status, statusText, \"请求返回\", responseText, currentTime, loadTime)\n        console.log(httpLogInfoEnd)\n        // httpLogInfoEnd.handleLogInfo(error.HTTP_LOG, httpLogInfoEnd)\n        // 当前请求成功后就，就将该对象的uploadFlag设置为true, 代表已经上传了\n        cache[i].uploadFlag = true\n    }\n\n    /**\n     * httpError log\n     * @param {*} uploadType 上传类型\n     * @param {*} url 请求地址\n     * @param {*} status 接口状态\n     * @param {*} statusText \n     * @param {*} statusResult \n     * @param {*} responseText\n     * @param {*} currentTime \n     * @param {*} loadTime \n     */\n    httpLogInfo(uploadType, url, status, statusText, statusResult, responseText, currentTime, loadTime) {\n        let obj = JSON.parse(JSON.stringify(util.getCommonProperty()))\n        obj.uploadType = uploadType  // 上传类型\n        obj.httpUrl = util.b64EncodeUnicode(encodeURIComponent(url)) // 请求地址\n        obj.status = status // 接口状态\n        obj.statusText = statusText // 状态描述\n        obj.statusResult = statusResult // 区分发起和返回状态\n        obj.happenTime = currentTime  // 客户端发送时间\n        obj.loadTime = loadTime // 接口请求耗时\n        obj.responseText = responseText // 接口返回数据\n        return obj\n    }\n\n    /**\n     * 重写window.fetch方法，为了能检测到浏览器api报错\n     * @return {?}\n     */\n    fetch() {\n        /**\n         * @param {*} name \n         * @return {?}\n         */\n        function normalizeName(name) {\n            if (\"string\" != typeof name && (name = String(name)), /[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n                throw new TypeError(\"Invalid character in header field name\");\n            }\n            return name.toLowerCase();\n        }\n        /**\n         * @param {string} name\n         * @return {?}\n         */\n        function normalizeValue(name) {\n            return \"string\" != typeof name && (name = String(name)), name;\n        }\n        /**\n         * @param {!Array} parent\n         * @return {?}\n         */\n        function fn(parent) {\n            var iterable = {\n                next: function () {\n                    var _eof = parent.shift();\n                    return {\n                        done: void 0 === _eof,\n                        value: _eof\n                    };\n                }\n            };\n            return n && (iterable[Symbol.iterator] = function () {\n                return iterable;\n            }), iterable;\n        }\n        /**\n         * @param {!Object} headers\n         * @return {undefined}\n         */\n        function Headers(headers) {\n            this.map = {};\n            if (headers instanceof Headers) {\n                headers.forEach(function (value, s) {\n                    this.append(s, value);\n                }, this);\n            } else {\n                if (Array.isArray(headers)) {\n                    headers.forEach(function (header) {\n                        this.append(header[0], header[1]);\n                    }, this);\n                } else {\n                    if (headers) {\n                        Object.getOwnPropertyNames(headers).forEach(function (name) {\n                            this.append(name, headers[name]);\n                        }, this);\n                    }\n                }\n            }\n        }\n        /**\n         * @param {?} body\n         * @return {?}\n         */\n        function consumed(body) {\n            if (body.bodyUsed) {\n                return Promise.reject(new TypeError(\"Already read\"));\n            }\n            /** @type {boolean} */\n            body.bodyUsed = true;\n        }\n        /**\n         * @param {!Object} x\n         * @return {?}\n         */\n        function require(x) {\n            return new Promise(function (fileCallback, callback) {\n                /**\n                 * @return {undefined}\n                 */\n                x.onload = function () {\n                    fileCallback(x.result);\n                };\n                /**\n                 * @return {undefined}\n                 */\n                x.onerror = function () {\n                    callback(x.error);\n                };\n            });\n        }\n        /**\n         * @param {?} value\n         * @return {?}\n         */\n        function done(value) {\n            /** @type {!FileReader} */\n            var f = new FileReader;\n            var result = require(f);\n            return f.readAsArrayBuffer(value), result;\n        }\n        /**\n         * @param {!Object} buffer\n         * @return {?}\n         */\n        function bufferClone(buffer) {\n            if (buffer.slice) {\n                return buffer.slice(0);\n            }\n            /** @type {!Uint8Array} */\n            var tmp = new Uint8Array(buffer.byteLength);\n            return tmp.set(new Uint8Array(buffer)), tmp.buffer;\n        }\n        /**\n         * @return {?}\n         */\n        function Body() {\n            return this.bodyUsed = false, this._initBody = function (body) {\n                if (this._bodyInit = body) {\n                    if (\"string\" == typeof body) {\n                        /** @type {string} */\n                        this._bodyText = body;\n                    } else {\n                        if (blobSupport && Blob.prototype.isPrototypeOf(body)) {\n                            /** @type {string} */\n                            this._bodyBlob = body;\n                        } else {\n                            if (parentElement && FormData.prototype.isPrototypeOf(body)) {\n                                /** @type {string} */\n                                this._bodyFormData = body;\n                            } else {\n                                if (isElement && URLSearchParams.prototype.isPrototypeOf(body)) {\n                                    this._bodyText = body.toString();\n                                } else {\n                                    if (range && blobSupport && isDataView(body)) {\n                                        this._bodyArrayBuffer = bufferClone(body.buffer);\n                                        /** @type {!Blob} */\n                                        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n                                    } else {\n                                        if (!range || !ArrayBuffer.prototype.isPrototypeOf(body) && !isArrayBufferView(body)) {\n                                            throw new Error(\"unsupported BodyInit type\");\n                                        }\n                                        this._bodyArrayBuffer = bufferClone(body);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    /** @type {string} */\n                    this._bodyText = \"\";\n                }\n                if (!this.headers.get(\"content-type\")) {\n                    if (\"string\" == typeof body) {\n                        this.headers.set(\"content-type\", \"text/plain;charset=UTF-8\");\n                    } else {\n                        if (this._bodyBlob && this._bodyBlob.type) {\n                            this.headers.set(\"content-type\", this._bodyBlob.type);\n                        } else {\n                            if (isElement && URLSearchParams.prototype.isPrototypeOf(body)) {\n                                this.headers.set(\"content-type\", \"application/x-www-form-urlencoded;charset=UTF-8\");\n                            }\n                        }\n                    }\n                }\n            }, blobSupport && (this.blob = function () {\n                var rejected = consumed(this);\n                if (rejected) {\n                    return rejected;\n                }\n                if (this._bodyBlob) {\n                    return Promise.resolve(this._bodyBlob);\n                }\n                if (this._bodyArrayBuffer) {\n                    return Promise.resolve(new Blob([this._bodyArrayBuffer]));\n                }\n                if (this._bodyFormData) {\n                    throw new Error(\"could not read FormData body as blob\");\n                }\n                return Promise.resolve(new Blob([this._bodyText]));\n            }, this.arrayBuffer = function () {\n                return this._bodyArrayBuffer ? consumed(this) || Promise.resolve(this._bodyArrayBuffer) : this.blob().then(done);\n            }), this.text = function () {\n                var rejected = consumed(this);\n                if (rejected) {\n                    return rejected;\n                }\n                if (this._bodyBlob) {\n                    return function (f) {\n                        /** @type {!FileReader} */\n                        var r = new FileReader;\n                        var io = require(r);\n                        return r.readAsText(f), io;\n                    }(this._bodyBlob);\n                }\n                if (this._bodyArrayBuffer) {\n                    return Promise.resolve(function (signature) {\n                        /** @type {!Uint8Array} */\n                        var result = new Uint8Array(signature);\n                        /** @type {!Array} */\n                        var n = new Array(result.length);\n                        /** @type {number} */\n                        var i = 0;\n                        for (; i < result.length; i++) {\n                            /** @type {string} */\n                            n[i] = String.fromCharCode(result[i]);\n                        }\n                        return n.join(\"\");\n                    }(this._bodyArrayBuffer));\n                }\n                if (this._bodyFormData) {\n                    throw new Error(\"could not read FormData body as text\");\n                }\n                return Promise.resolve(this._bodyText);\n            }, parentElement && (this.formData = function () {\n                return this.text().then(text2formData);\n            }), this.json = function () {\n                return this.text().then(JSON.parse);\n            }, this;\n        }\n        /**\n         * @param {!Object} input\n         * @param {!Object} options\n         * @return {undefined}\n         */\n        function Request(input, options) {\n            var body = (options = options || {}).body;\n            if (input instanceof Request) {\n                if (input.bodyUsed) {\n                    throw new TypeError(\"Already read\");\n                }\n                this.url = input.url;\n                this.credentials = input.credentials;\n                if (!options.headers) {\n                    this.headers = new Headers(input.headers);\n                }\n                this.method = input.method;\n                this.mode = input.mode;\n                if (!(body || null == input._bodyInit)) {\n                    body = input._bodyInit;\n                    /** @type {boolean} */\n                    input.bodyUsed = true;\n                }\n            } else {\n                /** @type {string} */\n                this.url = String(input);\n            }\n            if (this.credentials = options.credentials || this.credentials || \"omit\", !options.headers && this.headers || (this.headers = new Headers(options.headers)), this.method = function (shortMonthName) {\n                var looseWord = shortMonthName.toUpperCase();\n                return -1 < methods.indexOf(looseWord) ? looseWord : shortMonthName;\n            }(options.method || this.method || \"GET\"), this.mode = options.mode || this.mode || null, this.referrer = null, (\"GET\" === this.method || \"HEAD\" === this.method) && body) {\n                throw new TypeError(\"Body not allowed for GET or HEAD requests\");\n            }\n            this._initBody(body);\n        }\n        /**\n         * @param {!Object} body\n         * @return {?}\n         */\n        function text2formData(body) {\n            /** @type {!FormData} */\n            var form = new FormData;\n            return body.trim().split(\"&\").forEach(function (clusterShardData) {\n                if (clusterShardData) {\n                    var headersAndBody = clusterShardData.split(\"=\");\n                    var url = headersAndBody.shift().replace(/\\+/g, \" \");\n                    var filePath = headersAndBody.join(\"=\").replace(/\\+/g, \" \");\n                    form.append(decodeURIComponent(url), decodeURIComponent(filePath));\n                }\n            }), form;\n        }\n        /**\n         * @param {string} bodyInit\n         * @param {!Object} options\n         * @return {undefined}\n         */\n        function Response(bodyInit, options) {\n            options = options || {};\n            /** @type {string} */\n            this.type = \"default\";\n            this.status = \"status\" in options ? options.status : 200;\n            /** @type {boolean} */\n            this.ok = 200 <= this.status && this.status < 300;\n            this.statusText = \"statusText\" in options ? options.statusText : \"OK\";\n            this.headers = new Headers(options.headers);\n            this.url = options.url || \"\";\n            this._initBody(bodyInit);\n        }\n        /** @type {boolean} */\n        var isElement = \"URLSearchParams\" in self;\n        /** @type {boolean} */\n        var n = \"Symbol\" in self && \"iterator\" in Symbol;\n        var blobSupport = \"FileReader\" in self && \"Blob\" in self && function () {\n            try {\n                return new Blob, true;\n            } catch (e) {\n                return false;\n            }\n        }();\n        /** @type {boolean} */\n        var parentElement = \"FormData\" in self;\n        /** @type {boolean} */\n        var range = \"ArrayBuffer\" in self;\n        if (range) {\n            /** @type {!Array} */\n            var orderedPaneIds = [\"[object Int8Array]\", \"[object Uint8Array]\", \"[object Uint8ClampedArray]\", \"[object Int16Array]\", \"[object Uint16Array]\", \"[object Int32Array]\", \"[object Uint32Array]\", \"[object Float32Array]\", \"[object Float64Array]\"];\n            /**\n             * @param {string} obj\n             * @return {?}\n             */\n            var isDataView = function (obj) {\n                return obj && DataView.prototype.isPrototypeOf(obj);\n            };\n            /** @type {function(*): boolean} */\n            var isArrayBufferView = ArrayBuffer.isView || function (id) {\n                return id && -1 < orderedPaneIds.indexOf(Object.prototype.toString.call(id));\n            };\n        }\n        /**\n         * @param {string} name\n         * @param {string} value\n         * @return {undefined}\n         */\n        Headers.prototype.append = function (name, value) {\n            name = normalizeName(name);\n            value = normalizeValue(value);\n            var oldValue = this.map[name];\n            this.map[name] = oldValue ? oldValue + \",\" + value : value;\n        };\n        /**\n         * @param {string} name\n         * @return {undefined}\n         */\n        Headers.prototype.delete = function (name) {\n            delete this.map[normalizeName(name)];\n        };\n        /**\n         * @param {string} name\n         * @return {?}\n         */\n        Headers.prototype.get = function (name) {\n            return name = normalizeName(name), this.has(name) ? this.map[name] : null;\n        };\n        /**\n         * @param {string} name\n         * @return {?}\n         */\n        Headers.prototype.has = function (name) {\n            return this.map.hasOwnProperty(normalizeName(name));\n        };\n        /**\n         * @param {?} name\n         * @param {string} value\n         * @return {undefined}\n         */\n        Headers.prototype.set = function (name, value) {\n            this.map[normalizeName(name)] = normalizeValue(value);\n        };\n        /**\n         * @param {!Function} callback\n         * @param {?} thisp\n         * @return {undefined}\n         */\n        Headers.prototype.forEach = function (callback, thisp) {\n            var i;\n            for (i in this.map) {\n                if (this.map.hasOwnProperty(i)) {\n                    callback.call(thisp, this.map[i], i, this);\n                }\n            }\n        };\n        /**\n         * @return {?}\n         */\n        Headers.prototype.keys = function () {\n            /** @type {!Array} */\n            var params = [];\n            return this.forEach(function (canCreateDiscussions, post_content_type) {\n                params.push(post_content_type);\n            }), fn(params);\n        };\n        /**\n         * @return {?}\n         */\n        Headers.prototype.values = function () {\n            /** @type {!Array} */\n            var q = [];\n            return this.forEach(function (innerSource) {\n                q.push(innerSource);\n            }), fn(q);\n        };\n        /**\n         * @return {?}\n         */\n        Headers.prototype.entries = function () {\n            /** @type {!Array} */\n            var q = [];\n            return this.forEach(function (y, tiles) {\n                q.push([tiles, y]);\n            }), fn(q);\n        };\n        if (n) {\n            /** @type {function(): ?} */\n            Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n        }\n        /** @type {!Array} */\n        var methods = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"POST\", \"PUT\"];\n        /**\n         * @return {?}\n         */\n        Request.prototype.clone = function () {\n            return new Request(this, {\n                body: this._bodyInit\n            });\n        };\n        Body.call(Request.prototype);\n        Body.call(Response.prototype);\n        /**\n         * @return {?}\n         */\n        Response.prototype.clone = function () {\n            return new Response(this._bodyInit, {\n                status: this.status,\n                statusText: this.statusText,\n                headers: new Headers(this.headers),\n                url: this.url\n            });\n        };\n        /**\n         * @return {?}\n         */\n        Response.error = function () {\n            var response = new Response(null, {\n                status: 0,\n                statusText: \"\"\n            });\n            return response.type = \"error\", response;\n        };\n        /** @type {!Array} */\n        var removeDataListeners = [301, 302, 303, 307, 308];\n        /**\n         * @param {string} state\n         * @param {string} i\n         * @return {?}\n         */\n        Response.redirect = function (state, i) {\n            if (-1 === removeDataListeners.indexOf(i)) {\n                throw new RangeError(\"Invalid status code\");\n            }\n            return new Response(null, {\n                status: i,\n                headers: {\n                    location: state\n                }\n            });\n        };\n        /** @type {function(!Object): undefined} */\n        window.Headers = Headers;\n        /** @type {function(!Object, !Object): undefined} */\n        window.Request = Request;\n        /** @type {function(string, !Object): undefined} */\n        window.Response = Response;\n        /**\n         * @param {?} method\n         * @param {boolean} url\n         * @return {?}\n         */\n        window.fetch = function (method, url) {\n            return method, new Promise(function (resolve, reject) {\n                var request = new Request(method, url);\n                /** @type {!XMLHttpRequest} */\n                var xhr = new XMLHttpRequest;\n                /**\n                 * @return {undefined}\n                 */\n                xhr.onload = function () {\n                    /** @type {string} */\n                    var type = xhr.responseType;\n                    /** @type {string} */\n                    var response = \"\";\n                    var options = {\n                        status: xhr.status,\n                        statusText: xhr.statusText,\n                        headers: function (clusterShardData) {\n                            var h2 = new Headers;\n                            return clusterShardData.split(/\\r?\\n/).forEach(function (clusterShardData) {\n                                /** @type {!Array<string>} */\n                                var headersAndBody = clusterShardData.split(\":\");\n                                /** @type {string} */\n                                var style = headersAndBody.shift().trim();\n                                if (style) {\n                                    /** @type {string} */\n                                    var foo = headersAndBody.join(\":\").trim();\n                                    h2.append(style, foo);\n                                }\n                            }), h2;\n                        }(xhr.getAllResponseHeaders() || \"\")\n                    };\n                    options.url = \"responseURL\" in xhr ? xhr.responseURL : options.headers.get(\"X-Request-URL\");\n                    if (!(\"\" !== type && \"text\" !== type)) {\n                        /** @type {string} */\n                        response = xhr.responseText;\n                    }\n                    if (\"json\" === type) {\n                        /** @type {(Object|null|string)} */\n                        response = xhr.response;\n                    }\n                    /** @type {(Object|null|string)} */\n                    var body = \"response\" in xhr ? xhr.response : response;\n                    resolve(new Response(body, options));\n                };\n                /**\n                 * @return {undefined}\n                 */\n                xhr.onerror = function () {\n                    console.error(\"Network request failed\");\n                    reject(new TypeError(\"Network request failed\"));\n                };\n                /**\n                 * @return {undefined}\n                 */\n                xhr.ontimeout = function () {\n                    reject(new TypeError(\"Network request failed\"));\n                };\n                xhr.open(request.method, request.url, true);\n                if (\"include\" === request.credentials) {\n                    /** @type {boolean} */\n                    xhr.withCredentials = true;\n                }\n                if (\"responseType\" in xhr && blobSupport) {\n                    /** @type {string} */\n                    xhr.responseType = \"blob\";\n                }\n                request.headers.forEach(function (type, i) {\n                    xhr.setRequestHeader(i, type);\n                });\n                xhr.send(void 0 === request._bodyInit ? null : request._bodyInit);\n            });\n        };\n        /** @type {boolean} */\n        window.fetch.polyfill = true;\n    }\n}","import Util from \"../util/index\"\nimport * as error from '../config/index'\n\nconst util = Util.getInstance()\n\n/**\n * 统计页面性能\n */\nexport default class pageLog {\n\n    constructor() {\n\n    }\n\n    /**\n     * 单例\n     * @return {?}\n     */\n    static getInstance() {\n        if (!Page.instance) {\n            Page.instance = new Page()\n        }\n        return Page.instance\n    }\n\n    /**\n     * https://blog.csdn.net/lovenjoe/article/details/80260658\n     * DNS查询耗时 ：domainLookupEnd - domainLookupStart\n     * TCP链接耗时 ：connectEnd - connectStart\n     * request请求耗时 ：responseEnd - responseStart\n     * 解析dom树耗时 ： domComplete- domInteractive\n     * 白屏时间 ：responseStart - navigationStart\n     * domready时间 ：domContentLoadedEventEnd - navigationStart\n     * onload时间 ：loadEventEnd - navigationStart\n     * 相关资料\n     * https://segmentfault.com/a/1190000004010453\n     * https://github.com/fredshare/blog/issues/5\n     * https://javascript.ruanyifeng.com/bom/performance.html#toc5\n     */\n    pagePerformance() {\n        window.onload = () => {\n            let performance = window.performance\n            if (!performance) {\n                // 当前浏览器不支持\n                console.log('你的浏览器不支持 performance 接口');\n                return;\n            }\n            let times = performance.timing.toJSON()\n            // 发送页面性能指标数据, 上报内容 => \n            let perf = this._objectSpread({}, times, {\n                url: \"\".concat(window.location.host).concat(window.location.pathname)\n            })\n            // 页面耗时\n            // console.log(perf)\n            // 资源耗时\n            // console.log(performance.getEntries())\n            // 浏览器内存情况 usedJSHeapSize表示所有被使用的js堆栈内存；totalJSHeapSize表示当前js堆栈内存总大小，这表示usedJSHeapSize不能大于totalJSHeapSize，如果大于，有可能出现了内存泄漏。\n            // console.log(performance.memory)\n        }\n    }\n\n    /**\n     * @param {*} target \n     */\n    _objectSpread(target) {\n        for (let i = 1; i < arguments.length; i++) {\n            let source = arguments[i] != null ? arguments[i] : {}\n            let ownKeys = Object.keys(source)\n            if (typeof Object.getOwnPropertySymbols === 'function') {\n                ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter((sym) => {\n                    return Object.getOwnPropertyDescriptor(source, sym).enumerable\n                }))\n            }\n            ownKeys.forEach((key) => {\n                this._defineProperty(target, key, source[key])\n            })\n        }\n        return target\n    }\n\n    /**\n     * @param {*} obj \n     * @param {*} key \n     * @param {*} value \n     */\n    _defineProperty(obj, key, value) {\n        if (key in obj) {\n            Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true })\n        } else {\n            obj[key] = value\n        } return obj\n    }\n}","import Util from '../util/index'\nconst util = Util.getInstance()\n\n/**\n * 定时任务，避免浏览器并发\n */\nexport default class Queue {\n     /**\n     * 初始化\n     * @param {*} options \n     */\n    constructor(options) {\n        let config = {\n            isOpen: true,\n            synRequestNum: 4,\n            ver: '1.0.0'\n        }\n        // 进行参数合并\n        config = (!util.isBlank(options) && util.isType().isPlainObject(options)) ? Object.assign(config, options) : config\n\n        // 是否开启队列\n        this.isOpen = config.isOpen\n        // 队列\n        this.requestQueue = []\n        this.requestTimmer = undefined\n        // 队列控制并发数（暂定定4，后续可以根据浏览器io来决定给浏览器不同的策略）\n        // https://www.cnblogs.com/sunsky303/p/8862128.html\n        this.synRequestNum = !util.isBlank(config.synRequestNum) ? config.synRequestNum : 4\n        // 版本号\n        this.ver = config.ver\n        this.synNum = 0\n    }\n\n    /**\n     * 单例\n     * @param {*} structure 构造\n     * @param {*} option config配置\n     * @return {?}\n     */\n    static getInstance(structure, option) {\n        if (!Queue.instance || !Queue.instance[structure]) {\n            if (!Queue.instance) {\n                Queue.instance = {}\n            }\n            Queue.instance[structure] = new Queue(option)\n        }\n        return Queue.instance[structure]\n    }\n\n    /**\n     * 同步队列\n     * @param {*} log 队列日志 \n     */\n    pushToQueue(log) {\n        {\n            // var n = this.requestQueue && this.requestQueue.length\n            // 简单先同步放入数组中\n            this.requestQueue.push(log)\n            return this.onReady(() => {\n                this.requestTimmer = this.delay(() => {\n                    this.clear()\n                }, this.requestQueue[0] && (!!this.requestQueue[0].uploadType && this.requestQueue[0].uploadType == 'error') ? 3e3 : -1)\n            })\n        }\n    }\n\n    /**\n     * 宏任务（检测是否有唯一对应值）\n     * @param {*} fun \n     */\n    onReady(fun) {\n        // TOODO 检测是否有唯一项目id 没有则不上报\n        if (util.isType().isfunction(fun)) {\n            fun()\n        }\n    }\n\n    /**\n     * 执行队列\n     * @param {*} fun \n     * @param {*} e \n     */\n    delay(fun, e) {\n        if (!util.isType().isfunction(fun)) return null\n        return e === -1 ? (fun(), null) : setTimeout(fun, e || 0)\n    }\n\n    /**\n     * 并发限制\n     * @return {?}\n     */\n    clear() {\n        var e\n        if (this.synNum > this.synRequestNum) {\n            return clearTimeout(this.requestTimmer), this.requestTimmer = setTimeout(() => {\n                this.clear()\n            }, 50)\n        }\n        for (clearTimeout(this.requestTimmer), this.requestTimmer = null; this.synNum < this.synRequestNum && (e = this.requestQueue.pop()); this.synNum++) {\n            e.handleLog(this.reduceSynNumFun)\n        }\n        // 执行完如果还有数据则继续执行（放到宏任务）\n        !!this.requestQueue.length && (this.requestTimmer = setTimeout(() => {\n            this.clear()\n        }, 50))\n\n    }\n\n    /**\n     * 清空队列\n     * @return {?}\n     */\n    clearAll() {\n        this.requestQueue = []\n        this.requestTimmer = null\n        this.synNum = 0\n    }\n\n    /**\n     * 并发数减一\n     * @return {?}\n     */\n    reduceSynNumFun() {\n        Queue.instance.synNum--\n        return this\n    }\n\n}","import Util from './util/index'\nimport jsLog from './log/jsLog'\nimport rescourceLog from './log/rescourceLog'\nimport httpLog from './log/httpLog'\nimport pageLog from './log/page'\nimport Queue from './queue/index'\nimport '@babel/polyfill'\n\nlet util = null\n\nexport default class Monitor {\n\n    /**\n     * 初始化\n     * @param {*} options { monitorUser: {userId: 用户ID, firstUserParam: 用户自定义配置，secondUserParam: 第二个参数}, WEB_MONITOR_ID: 项目id, synRequestNum: 定时任务 }\n     */\n    constructor(options) {\n        // 初始化框架基础参数\n        this.options = (options === null || options === undefined || options === \"\") ? options : {}\n\n        let utilConfig = {\n            monitorUser: this.options.monitorUser || {},\n            WEB_MONITOR_ID: this.options.WEB_MONITOR_ID || \"\"\n        }\n\n        let queueConfig = {\n            synRequestNum: this.options.synRequestNum || null\n        }\n        util = Util.getInstance(utilConfig)\n        Queue.getInstance('web', queueConfig)\n\n        this.init()\n        // this.content()\n        this.run()\n    }\n\n    /**\n     * 初始化\n     */\n    init() {\n        // 获取设备信息\n        util.getDevice()\n        // 存储唯一uuid\n        util.getCustomerKey()\n        // 存储ip地址\n        util.getIp()\n    }\n\n    /**\n     * 运行监听\n     */\n    run() {\n        // 监控js\n        jsLog.getInstance().recordJavaScriptError()\n        // 资源监控\n        rescourceLog.getInstance().recordResourceError()\n        // http 请求监控\n        httpLog.getInstance().recordHttpError()\n        // 页面监控\n        pageLog.getInstance().pagePerformance()\n        // pv uv监控\n\n        // mv 半自动化埋点（支持热区埋点）\n    }\n\n    /**\n     * 启动发送 pv\n     * @return {?}\n     */\n    content() {\n\n    }\n\n}"],"names":["Util","constructor","options","device","ua","navigator","userAgent","ios","android","iphone","ipad","androidChrome","isWeixin","test","os","deviceName","o","monitorIp","country","uuid","isBlank","getInstance","instance","getDevice","match","showEffects","showPackageConstants","showConstants","cache_message","osVersion","toLowerCase","indexOf","replace","split","beginWidth","window","screen","width","upperHeight","height","d","browserName","assignmentUrl","browserVersion","webView","Object","isType","_obj","isNumeric","isBoolean","isString","isNull","isUndefined","isSymbol","isPlainObject","isArray","isRegExp","isDate","isfunction","isWindow","_type","_toString","toString","key","hasOwnProperty","reg","RegExp","anonymous","val","call","obj","undefined","parseUrlParams","url","substr","paramsArr","params","forEach","item","kv","decodeURIComponent","getQueryObject","search","substring","lastIndexOf","base_url","rs","$1","$2","name","String","baseUrl","query","makeQuery","queryObject","entries","reduce","result","entry","push","join","funcUrlDel","loca","location","origin","pathname","arr","i","length","JSON","stringify","getUuid","_transactionName","Date","getTime","c","r","Math","random","getCustomerKey","getCookie","dateExpires","setTime","document","cookie","toGMTString","t","re2","unescape","getIp","cb","loadJs","_","opt_by","returnCitySN","cip","urlSafeNodeName","encodeURIComponent","cname","js","callback","script","createElement","async","src","onload","onerror","mContainer","getElementsByTagName","parentNode","insertBefore","b64EncodeUnicode","str","btoa","canCreateDiscussions","index","fromCharCode","e","encryptObj","s","conf_shortcuts_icon","getCommonProperty","logObj","userInfo","util","monitorUser","happenTime","webMonitorId","WEB_MONITOR_ID","simpleUrl","href","customerKey","pageKey","province","city","userId","firstUserParam","secondUserParam","JS_ERROR","RESOURCE_LOAD","HTTP_LOG","jsLog","recordJavaScriptError","siftAndMakeUpMessage","origin_errorMsg","origin_url","origin_lineNumber","origin_columnNumber","origin_errorObj","errorMsg","errorObj","errorType","errorStackStr","javaScriptErrorInfo","error","console","log","jsMonitorStarted","oldError","arguments","message","lineNumber","columnNumber","stack","apply","errorStack","onunhandledrejection","event","errorMessage","th_field","reason","uploadType","parse","browserInfo","rescourceLog","recordResourceError","addEventListener","typeName","target","localName","sourceUrl","resoureErrorInfo","resourceErrorInfo","errorUrl","errorName","cache","httpLog","timeRecordArray","recordHttpError","XMLHttpRequest","fire","CustomEvent","detail","dispatchEvent","xhr","tempObj","timeStamp","uploadFlag","self","status","responseType","reader","FileReader","handleHttpResult","readAsText","response","id","responseText","fetch","tempResponseText","currentTime","responseURL","statusText","loadTime","httpLogInfoStart","httpLogInfo","httpLogInfoEnd","statusResult","httpUrl","normalizeName","TypeError","normalizeValue","fn","parent","iterable","next","_eof","shift","done","value","n","Symbol","iterator","Headers","headers","map","append","Array","header","getOwnPropertyNames","consumed","body","bodyUsed","Promise","reject","require","x","fileCallback","f","readAsArrayBuffer","bufferClone","buffer","slice","tmp","Uint8Array","byteLength","set","Body","_initBody","_bodyInit","_bodyText","blobSupport","Blob","prototype","isPrototypeOf","_bodyBlob","parentElement","FormData","_bodyFormData","isElement","URLSearchParams","range","isDataView","_bodyArrayBuffer","ArrayBuffer","isArrayBufferView","Error","get","type","blob","rejected","resolve","arrayBuffer","then","text","io","signature","formData","text2formData","json","Request","input","credentials","method","mode","shortMonthName","looseWord","toUpperCase","methods","referrer","form","trim","clusterShardData","headersAndBody","filePath","Response","bodyInit","ok","orderedPaneIds","DataView","isView","oldValue","delete","has","thisp","keys","post_content_type","values","q","innerSource","y","tiles","clone","removeDataListeners","redirect","state","RangeError","request","h2","style","foo","getAllResponseHeaders","ontimeout","open","withCredentials","setRequestHeader","send","polyfill","pageLog","Page","pagePerformance","performance","times","timing","toJSON","perf","_objectSpread","concat","host","source","ownKeys","getOwnPropertySymbols","filter","sym","getOwnPropertyDescriptor","enumerable","_defineProperty","defineProperty","configurable","writable","Queue","config","isOpen","synRequestNum","ver","assign","requestQueue","requestTimmer","synNum","structure","option","pushToQueue","onReady","delay","clear","fun","setTimeout","clearTimeout","pop","handleLog","reduceSynNumFun","clearAll","Monitor","utilConfig","queueConfig","init","run","content"],"mappings":"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"}